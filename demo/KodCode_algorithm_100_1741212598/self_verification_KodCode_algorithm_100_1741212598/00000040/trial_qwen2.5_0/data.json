{
  "metadata": {
    "prompt_id": "00000040",
    "row_id": 40,
    "seed_ids": [
      318
    ],
    "mode": "algorithm"
  },
  "instruction": "**Scenario**: You are working on a network analysis project where you need to manage a group of network nodes and their connections. The network nodes can form various clusters, and you need to efficiently manage these clusters using a disjoint set data structure.\n\n**Task**: Implement a function `analyze_network_connections` that takes a list of network nodes and their connections and returns the number of unique clusters in the network. Each node is represented by an integer, and each connection is a tuple of two integers representing nodes that are connected.\n\n**Function Signature**: \n```python\ndef analyze_network_connections(connections: List[Tuple[int, int]]) -> int:\n    pass\n```\n\n**Input**:\n- `connections` (1 <= len(connections) <= 10^5): A list of tuples, where each tuple (u, v) represents a connection between nodes u and v.\n\n**Output**:\n- An integer representing the number of unique clusters in the network.\n\n**Constraints**:\n- Each node can appear in multiple connections.\n- The nodes are 0-indexed and range from 0 to 10^4.\n\n**Performance Requirement**:\n- The function should be efficient and able to handle the maximum input size in a reasonable amount of time.\n\n**Example**:\n```python\nconnections = [(0, 1), (1, 2), (3, 4), (4, 5), (2, 6)]\nassert analyze_network_connections(connections) == 3\n```\n\n**Explanation**:\n- Initially, there are 7 nodes.\n- After processing the connections, the network will have 3 unique clusters: {0, 1, 2, 6}, {3, 4, 5}, and {7}.\n\n**Additional Information**:\n- You can assume the disjoint set data structure will be provided as a module or class with the necessary methods (`merge` and `get_parent`).",
  "solution_code": "from typing import List, Tuple\n\ndef analyze_network_connections(connections: List[Tuple[int, int]]) -> int:\n    \"\"\"\n    Analyzes network connections and returns the number of unique clusters.\n    \"\"\"\n    from disjoint_set import DisjointSet  # Import the disjoint set data structure module\n\n    # Initialize the disjoint set structure\n    ds = DisjointSet()\n    \n    # Add all nodes to the disjoint set\n    for u, v in connections:\n        ds.merge(u, v)\n    \n    # Count the number of unique clusters (distinct parent nodes)\n    unique_clusters = set(ds.get_parent(node) for node in range(len(ds)))\n    \n    return len(unique_clusters)",
  "test_code": "import pytest\nfrom solution import analyze_network_connections\n\ndef test_network_connections_example():\n    connections = [(0, 1), (1, 2), (3, 4), (4, 5), (2, 6)]\n    assert analyze_network_connections(connections) == 3\n\ndef test_single_connection():\n    connections = [(0, 1)]\n    assert analyze_network_connections(connections) == 1\n\ndef test_no_connections():\n    connections = []\n    assert analyze_network_connections(connections) == 10  # Assuming maximum nodes are 10 as given constraint 0 to 10^4\n\ndef test_complex_connections():\n    connections = [(0, 1), (2, 3), (4, 5), (5, 6), (7, 8), (8, 7)]\n    assert analyze_network_connections(connections) == 4\n\ndef test_duplicate_connections():\n    connections = [(0, 1), (1, 0), (2, 3), (3, 2), (4, 5), (5, 4)]\n    assert analyze_network_connections(connections) == 3\n\ndef test_strongly_connected_graph():\n    connections = [(0, 1), (1, 2), (2, 0), (3, 4), (4, 5), (5, 3)]\n    assert analyze_network_connections(connections) == 1",
  "file_source": "KodCode_questions2sv_algorithm_100_1741212598_sanitized_prepared_results0.jsonl"
}